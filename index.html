<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Antonio Di Cello" >
    <link rel="shortcut icon" href="images/favicon.png">

    <title>OSNF Admin Console</title>

    <!--Core CSS -->
    <link href="bs3/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/bootstrap-reset.css" rel="stylesheet">
    <link href="font-awesome/css/font-awesome.css" rel="stylesheet" />

    <!-- Custom styles for this template -->
    <link href="css/style.css" rel="stylesheet">
    <link href="css/style-responsive.css" rel="stylesheet" />
    <script type="text/javascript"
	src="http://bernii.github.io/gauge.js/dist/gauge.min.js"></script>
	
	<style type="text/css">
		.indicator {
			float:left;
			width:330px;
		}
		
		.value {
			width:330px;
		}
	
	</style>

</head>

<body>

<section id="container" >
<!--header start-->
<header class="header fixed-top clearfix">
<!--logo start-->
<div class="brand">

    <a href="index.html" class="logo">
        <img src="images/logo.png" alt="">
    </a>
    <div class="sidebar-toggle-box">
        <div class="fa fa-bars"></div>
    </div>
</div>
<!--logo end-->

<div class="nav notify-row" id="top_menu">
    <!--  notification start -->
    <ul class="nav top-menu">
        <!-- settings start -->
        <li class="dropdown">
            <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                <i class="fa fa-tasks"></i>
                <span class="badge bg-success">8</span>
            </a>
            <ul class="dropdown-menu extended tasks-bar">
                <li>
                    <p class="">You have 8 pending tasks</p>
                </li>
                <li>
                    <a href="#">
                        <div class="task-info clearfix">
                            <div class="desc pull-left">
                                <h5>Target Sell</h5>
                                <p>25% , Deadline  14 Set 14</p>
                            </div>
                                    <span class="notification-pie-chart pull-right" data-percent="45">
                            <span class="percent"></span>
                            </span>
                        </div>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <div class="task-info clearfix">
                            <div class="desc pull-left">
                                <h5>Product Delivery</h5>
                                <p>45% , Deadline  12 Oct 14</p>
                            </div>
                                    <span class="notification-pie-chart pull-right" data-percent="78">
                            <span class="percent"></span>
                            </span>
                        </div>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <div class="task-info clearfix">
                            <div class="desc pull-left">
                                <h5>Payment collection</h5>
                                <p>87% , Deadline  12 Nov 14</p>
                            </div>
                                    <span class="notification-pie-chart pull-right" data-percent="60">
                            <span class="percent"></span>
                            </span>
                        </div>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <div class="task-info clearfix">
                            <div class="desc pull-left">
                                <h5>Target Sell</h5>
                                <p>33% , Deadline  12 June 15</p>
                            </div>
                                    <span class="notification-pie-chart pull-right" data-percent="90">
                            <span class="percent"></span>
                            </span>
                        </div>
                    </a>
                </li>

                <li class="external">
                    <a href="#">See All Tasks</a>
                </li>
            </ul>
        </li>
        <!-- settings end -->
        <!-- inbox dropdown start-->
        <li id="header_inbox_bar" class="dropdown">
            <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                <i class="fa fa-envelope-o"></i>
                <span class="badge bg-important">4</span>
            </a>
            <ul class="dropdown-menu extended inbox">
                <li>
                    <p class="red">You have 4 Mails</p>
                </li>
                <li>
                    <a href="#">
                        <span class="photo"><img alt="avatar" src="images/avatar-mini.jpg"></span>
                                <span class="subject">
                                <span class="from">Antonio Di Cello</span>
                                <span class="time">Just now</span>
                                </span>
                                <span class="message">
                                    Hello, this is an example msg.
                                </span>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <span class="photo"><img alt="avatar" src="images/avatar-mini-2.jpg"></span>
                                <span class="subject">
                                <span class="from">Immacolata Conforti</span>
                                <span class="time">2 min ago</span>
                                </span>
                                <span class="message">
                                    Hello, this is an example msg.
                                </span>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <span class="photo"><img alt="avatar" src="images/avatar-mini-3.jpg"></span>
                                <span class="subject">
                                <span class="from">Alessandro Galasso</span>
                                <span class="time">2 days ago</span>
                                </span>
                                <span class="message">
                                    Hello, this is an example msg.
                                </span>
                    </a>
                </li>
                <li>
                    <a href="#">See all messages</a>
                </li>
            </ul>
        </li>
        <!-- inbox dropdown end -->
        <!-- notification dropdown start-->
        <li id="header_notification_bar" class="dropdown">
            <a data-toggle="dropdown" class="dropdown-toggle" href="#">

                <i class="fa fa-bell-o"></i>
                <span class="badge bg-warning">3</span>
            </a>
            <ul class="dropdown-menu extended notification">
                <li>
                    <p>Notifications</p>
                </li>
                <li>
                    <div class="alert alert-info clearfix">
                        <span class="alert-icon"><i class="fa fa-bolt"></i></span>
                        <div class="noti-info">
                            <a href="#"> Node #1 overloaded.</a>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="alert alert-danger clearfix">
                        <span class="alert-icon"><i class="fa fa-bolt"></i></span>
                        <div class="noti-info">
                            <a href="#"> Node #2 overloaded.</a>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="alert alert-success clearfix">
                        <span class="alert-icon"><i class="fa fa-bolt"></i></span>
                        <div class="noti-info">
                            <a href="#"> Node #3 overloaded.</a>
                        </div>
                    </div>
                </li>

            </ul>
        </li>
        <!-- notification dropdown end -->
    </ul>
    <!--  notification end -->
</div>
<div class="top-nav clearfix">
    <!--search & user info start-->
    <ul class="nav pull-right top-menu">
        <li>
            <input type="text" class="form-control search" placeholder=" Search">
        </li>
        <!-- user login dropdown start-->
        <li class="dropdown">
            <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                <img alt="" src="images/avatar1_small.jpg">
                <span class="username">Vincenzo Pirrone</span>
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu extended logout">
                <li><a href="#"><i class=" fa fa-suitcase"></i>Profile</a></li>
                <li><a href="#"><i class="fa fa-cog"></i> Settings</a></li>
                <li><a href="login.html"><i class="fa fa-key"></i> Log Out</a></li>
            </ul>
        </li>
        <!-- user login dropdown end -->
        <li>
            <div class="toggle-right-box">
                <div class="fa fa-bars"></div>
            </div>
        </li>
    </ul>
    <!--search & user info end-->
</div>
</header>
<!--header end-->
<aside>
    <div id="sidebar" class="nav-collapse">
        <!-- sidebar menu start-->            
        <div class="leftside-navigation">
            <ul class="sidebar-menu" id="nav-accordion">
            <li>
                <a href="javascript:;">
                    <i class="fa fa-dashboard"></i>
                    <span>Dashboard</span>
                </a>
            </li>
            <li class="sub-menu">
                <a href="javascript:;">
                    <i class="fa fa-laptop"></i>
                    <span>Station</span>
                </a>
                <ul class="sub">
                </ul>
            </li>
            <li class="sub-menu">
                <a href="javascript:;">
                    <i class="fa fa-book"></i>
                    <span>Documentation</span>
                </a>
                <ul class="sub">
                </ul>
            </li>
            <li>
                <a href="javascript:;">
                    <i class="fa fa-bullhorn"></i>
                    <span>Alert</span>
                </a>
            </li>
            <li class="sub-menu">
                <a href="javascript:;">
                    <i class="fa fa-th"></i>
                    <span>Data</span>
                </a>
                <ul class="sub">
                </ul>
            </li>
            <li class="sub-menu">
                <a href="javascript:;">
                    <i class="fa fa-envelope"></i>
                    <span>Mail </span>
                </a>
            </li>
            <li class="sub-menu">
                <a href="javascript:;">
                    <i class=" fa fa-bar-chart-o"></i>
                    <span>Charts</span>
                </a>
            </li>
            <li class="sub-menu">
                <a href="javascript:;">
                    <i class=" fa fa-bar-chart-o"></i>
                    <span>Maps</span>
                </a>
            </li>
        </ul></div>        
<!-- sidebar menu end-->
    </div>
</aside>
<!--sidebar end-->
    <!--main content start-->
    <section id="main-content">
        <section class="wrapper">
<div>
<div><p>STATION: 1</p><p>SENSOR: OSA 1</p><p><img src="images/geo.png"> POSITION: RENDE lat: 39.343495 lon: 16.194757</p></div>   
</div>

        <!-- page start-->
        <div class="row">
            <div class="col-sm-12">
                <section class="panel">
                    <header class="panel-heading">
                        Sensors Data: Brightness
                          <span class="tools pull-right">
                            <a href="javascript:;" class="fa fa-chevron-down"></a>
                            <a href="javascript:;" class="fa fa-cog"></a>
                            <a href="javascript:;" class="fa fa-times"></a>
                         </span>
                    </header>
                    <div class="panel-body" align="center">
                    	<div class="indicator">
								
<table class="table table-bordered">
<tr>
<td><canvas id="brightness"></canvas></td>
<td><table>
<tr>
<td><img src="images/bulb.png"></td>
<td style="width:200px">Brightness Val</td>
<td><div class="value" id="brightness_val">0</div></td>
</tr>
<tr>
<td> </td>
<td style="width:200px">Avg</td>
<td><div class="value" id="brightness_avg">0</div></td>
</tr>
<tr>
<td> </td>
<td style="width:200px">Min</td>
<td><div class="value" id="brightness_min">0</div></td>
</tr>
<tr>
<td> </td>
<td style="width:200px">Max</td>
<td><div class="value" id="brightness_max">0</div></td>
</tr>
</table></td>
</tr>
</table>    

                        </div>           
                    </div>
                </section>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-12">
                <section class="panel">
                    <header class="panel-heading">
                        Sensors Data: Temperature
                        <span class="tools pull-right">
                            <a href="javascript:;" class="fa fa-chevron-down"></a>
                            <a href="javascript:;" class="fa fa-cog"></a>
                            <a href="javascript:;" class="fa fa-times"></a>
                         </span>
                    </header>
                    <div class="panel-body" align="center">
                        <div style="float:left;width:330px;">
<!--                             <canvas id="temperature"></canvas>
                            <div class="value" id="temperature_val">0</div>
                            <div class="value" id="temperature_avg">0</div>
                            <div class="value" id="temperature_min">0</div>
                            <div class="value" id="temperature_max">0</div> -->
                      
<table class="table table-bordered">
<tr>
<td><canvas id="temperature"></canvas></td>
<td><table>
<tr>
<td><img src="images/temp.png"></td>
<td style="width:200px">Temperature Val</td>
<td><div class="value" id="temperature_val">0</div></td>
</tr>
<tr>
<td></td>
<td style="width:200px" >Avg</td>
<td> <div class="value" id="temperature_avg">0</div></td>
</tr>
<tr>
<td></td>
<td style="width:200px">Min</td>
<td><div class="value" id="temperature_min">0</div></td>
</tr>
<tr>
<td></td>
<td style="width:200px">Max</td>
<td><div class="value" id="temperature_max">0</div></td>
</tr>
</table></td>
</tr>
</table>                               
                            
                        </div>
                        
                    </div>
                </section>
            </div>
        </div>

         <div class="row">
            <div class="col-sm-12">
                <section class="panel">
                    <header class="panel-heading">
                        Sensors Data: Humidity
                        <span class="tools pull-right">
                         <a href="javascript:;" class="fa fa-chevron-down"></a>
                         <a href="javascript:;" class="fa fa-cog"></a>
                         <a href="javascript:;" class="fa fa-times"></a>
                         </span>
                    </header>
                    <div class="panel-body" align="center">
                        <div style="float:left;width:330px;">
<!--                             <canvas id="humidity"></canvas>
                            <div class="value" id="humidity_val">0</div>
                            <div class="value" id="humidity_avg">0</div>
                            <div class="value" id="humidity_min">0</div>
                            <div class="value" id="humidity_max">0</div>
                        </div>
                         -->
<table class="table table-bordered">
<tr>
<td> <canvas id="humidity"></canvas></td>
<td><table>
<tr>
<td><img src="images/hum.png"></td>
<td>Humidity Val</td>
<td><div class="value" id="humidity_val">0</div></td>
</tr>
<tr>
<td></td>
<td>Avg</td>
<td> <div class="value" id="humidity_avg">0</div></td>
</tr>
<tr>
<td></td>
<td>Min</td>
<td> <div class="value" id="humidity_min">0</div></td>
</tr>
<tr>
<td></td>
<td>Max</td>
<td><div class="value" id="humidity_max">0</div></td>
</tr>
</table></td>
</tr>
</table>                                
                        
                    </div>
                </section>
            </div>
        </div>
        <!-- page end-->
        </section>
    </section>
    <!--main content end-->
<!--right sidebar start-->
<div class="right-sidebar">
<div class="search-row">
    <input type="text" placeholder="Search" class="form-control">
</div>
<div class="right-stat-bar">
<ul class="right-side-accordion">

<li class="widget-collapsible">
    <a href="#" class="head widget-head terques-bg active clearfix">
        <span class="pull-left">contact online (5)</span>
        <span class="pull-right widget-collapse"><i class="ico-minus"></i></span>
    </a>
    
</div>
</div>
<!--right sidebar end-->

</section>

<!-- Placed js at the end of the document so the pages load faster -->

<!--Core js-->
<script src="js/jquery.js"></script>
<script src="bs3/js/bootstrap.min.js"></script>
<script class="include" type="text/javascript" src="js/jquery.dcjqaccordion.2.7.js"></script>
<script src="js/jquery.scrollTo.min.js"></script>
<script src="js/jQuery-slimScroll-1.3.0/jquery.slimscroll.js"></script>
<script src="js/jquery.nicescroll.js"></script>
<!--Easy Pie Chart-->
<script src="js/easypiechart/jquery.easypiechart.js"></script>
<!--Sparkline Chart-->
<script src="js/sparkline/jquery.sparkline.js"></script>
<!--jQuery Flot Chart-->
<script src="js/flot-chart/jquery.flot.js"></script>
<script src="js/flot-chart/jquery.flot.tooltip.min.js"></script>
<script src="js/flot-chart/jquery.flot.resize.js"></script>
<script src="js/flot-chart/jquery.flot.pie.resize.js"></script>


<!--common script init for all pages-->
<script src="js/scripts.js"></script>

<script type="text/javascript">

var opts = {
		lines : 12, // The number of lines to draw
		angle : 0.15, // The length of each line
		lineWidth : 0.44, // The line thickness
		pointer : {
			length : 0.5, // The radius of the inner circle
			strokeWidth : 0.035, // The rotation offset
			color : '#000000' // Fill color
		},
		limitMax : 'false', // If true, the pointer will not go past the end of the gauge
		colorStart : '#6FADCF', // Colors
        colorStop : '#FF8000', // just experiment with them
		strokeColor : '#E0E0E0', // to see which ones work best for you
		generateGradient : true
	};
	var lightCanvas = document.getElementById('brightness');
	var tempCanvas = document.getElementById('temperature');
	var humCanvas = document.getElementById('humidity');
	
	var lightGauge = new Gauge(lightCanvas).setOptions(opts);
	var tempGauge = new Gauge(tempCanvas).setOptions(opts); 
	var humGauge = new Gauge(humCanvas).setOptions(opts); 
	var indicators = [lightGauge, tempGauge, humGauge];
	indicators.forEach(function(gauge) {
		gauge.maxValue = 3000; // set max gauge value
		gauge.animationSpeed = 32; // set animation speed (32 is default value)
		gauge.set(0); // set actual value
	});
	
	update_gauge = function(gauge, span, value){
		gauge.set(value*10);
		span.text(value);
	};
	
	update = function(values){
        
        var brightness_new ;

        if (values.brightness > 300) {
           brightness_new = 0;
        }
        else {
           brightness_new = (300-values.brightness);
        }   
        
		update_gauge(lightGauge, $('#brightness_val'), brightness_new);
		update_gauge(tempGauge, $('#temperature_val'), values.temperature);
		update_gauge(humGauge, $('#humidity_val'), values.humidity);
	};
	
	get_values = function(){
		$.ajax({
            url: "http://10.186.64.209:5000/v2/nodo1/OSA1",
            type: "GET",
            dataType: "json",
            success: function (response) {
            	values = response;
                update(values);
            },
            error: function (xhr, status) {
            	alert('errore');
            }
        });
	}
	get_values();
	
	
	
	query_mongo = function(){
		$.ajax({
            url: "http://sensornet.apphb.com/api/values/1",
            type: "GET",
            dataType: "json",
            success: function (response) {
            	mongo = JSON.parse(response);
            	mongo.values.forEach(function(elem){
            		var avg = "#" + elem.type + "_avg";
            		var min = "#" + elem.type + "_min";
            		var max = "#" + elem.type + "_max";
            		$(avg).text(elem.Avg);
            		$(min).text(elem.Min);
            		$(max).text(elem.Max);
            	});
            },
            error: function (xhr, status) {
            	alert('errore');
            }
        });
	}
	query_mongo();

	setInterval(get_values, 3000);
	setInterval(query_mongo, 60000);

</script>

</body>
</html>
